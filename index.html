<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minah Teacher's English Class Points</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒŸ</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <script>
        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyBdyW1w2iq79U44QDC0A_73PrcF4iWdZ9s",
            authDomain: "minah-teacher-s-class-points.firebaseapp.com",
            projectId: "minah-teacher-s-class-points",
            storageBucket: "minah-teacher-s-class-points.firebasestorage.app",
            messagingSenderId: "50388651847",
            appId: "1:50388651847:web:0607a021e7f3ed3c1b8662"
        };
        
        // Firebase ì´ˆê¸°í™”
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        console.log('Firebase ì´ˆê¸°í™” ì™„ë£Œ');
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap');
        body { font-family: 'Nunito', sans-serif; }
        .cute-shadow { box-shadow: 0 4px 15px rgba(255, 182, 193, 0.3); }
        .point-card { transition: all 0.3s ease; }
        .point-card:hover { transform: translateY(-2px); }
        .menu-item { transition: all 0.3s ease; }
        .menu-item:hover { background-color: rgba(238, 242, 255, 0.8) !important; transform: translateX(4px); }
        .menu-item.active { background-color: rgba(224, 231, 255, 0.9) !important; }
        .login-container { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .shape {
            position: absolute;
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
        }
        .shape:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .shape:nth-child(2) { top: 20%; right: 10%; animation-delay: 2s; }
        .shape:nth-child(3) { bottom: 10%; left: 20%; animation-delay: 4s; }
        .shape:nth-child(4) { bottom: 20%; right: 20%; animation-delay: 1s; }
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
    </style>
</head>
<body>
    <!-- êµ¬ê¸€ ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="loginScreen" class="login-container flex items-center justify-center relative">
        <div class="floating-shapes">
            <div class="shape w-20 h-20 bg-white rounded-full"></div>
            <div class="shape w-16 h-16 bg-pink-300 rounded-full"></div>
            <div class="shape w-24 h-24 bg-yellow-300 rounded-full"></div>
            <div class="shape w-12 h-12 bg-blue-300 rounded-full"></div>
        </div>
        
        <div class="bg-white rounded-3xl cute-shadow p-8 max-w-md w-full mx-4 relative z-10">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">ğŸŒŸ</div>
                <h1 class="text-3xl font-bold text-purple-600 mb-2">Minah Teacher's</h1>
                <h2 class="text-xl text-gray-600">English Class Points</h2>
                <p class="text-sm text-gray-500 mt-2">êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”</p>
            </div>
            
            <div class="space-y-4">
                <button id="googleLoginBtn" class="w-full bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white py-4 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center">
                    <svg class="w-6 h-6 mr-3" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
                </button>
                
                <div class="text-center">
                    <p class="text-xs text-gray-500">
                        ğŸ”’ ì•ˆì „í•œ êµ¬ê¸€ ì¸ì¦ìœ¼ë¡œ ë³´í˜¸ë©ë‹ˆë‹¤
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- êµì‚¬ ì¸ì¦ í™”ë©´ -->
    <div id="verificationScreen" class="login-container flex items-center justify-center relative hidden">
        <div class="bg-white rounded-3xl cute-shadow p-8 max-w-md w-full mx-4">
            <div class="text-center mb-8">
                <div class="text-6xl mb-4">ğŸ”</div>
                <h2 class="text-2xl font-bold text-purple-600 mb-2">êµì‚¬ ì¸ì¦</h2>
                <p id="userEmail" class="text-gray-600 mb-4"></p>
                <p class="text-sm text-gray-500">êµì‚¬ ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</p>
            </div>
            
            <div class="space-y-4">
                <input type="password" id="verificationCode" placeholder="ì¸ì¦ ì½”ë“œ ì…ë ¥" 
                       class="w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none text-center text-lg font-bold tracking-widest">
                <div class="flex space-x-3">
                    <button id="verifyBtn" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-semibold transition-colors">
                        âœ… ì¸ì¦í•˜ê¸°
                    </button>
                    <button id="cancelBtn" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-xl font-semibold transition-colors">
                        ì·¨ì†Œ
                    </button>
                </div>
                <div class="text-center">
                    <p class="text-xs text-gray-500">
                        ğŸ” ê´€ë¦¬ìë¡œë¶€í„° ë°›ì€ ì¸ì¦ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- ë©”ì¸ ì•± -->
    <div id="mainApp" class="hidden">
        <!-- í—¤ë” -->
        <div class="bg-white cute-shadow mb-8 sticky top-0 z-40">
            <div class="container mx-auto px-4 md:px-6 py-4">
                <div class="flex justify-between items-center">
                    <h1 class="text-lg md:text-4xl font-black text-indigo-700 ml-12 md:ml-0" style="font-family: 'Nunito', sans-serif; text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">ğŸŒŸ Minah Teacher's Class Points</h1>
                    <div class="flex items-center space-x-2 md:space-x-4">
                        <span id="userInfo" class="text-sm md:text-base text-purple-600 font-semibold"></span>
                        <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white px-3 md:px-6 py-2 rounded-full font-semibold transition-colors text-xs md:text-base">
                            ğŸšª ë¡œê·¸ì•„ì›ƒ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ëª¨ë°”ì¼ ë©”ë‰´ í† ê¸€ -->
        <button id="mobileMenuToggle" class="md:hidden fixed top-4 left-4 z-50 bg-purple-500 text-white p-3 rounded-full shadow-lg">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
        </button>

        <div class="flex">
            <!-- ì‚¬ì´ë“œë°” -->
            <div id="sidebar" class="w-56 md:w-56 bg-gradient-to-b from-purple-100 via-indigo-100 to-violet-100 h-screen fixed left-0 top-0 pt-24 px-4 shadow-2xl transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-40">
                <div class="space-y-3">
                    <div class="text-sm md:text-lg font-bold text-indigo-700 mb-3 px-3">ğŸ“… í•™ë…„ë„ ì„ íƒ</div>
                    <select id="yearSelect" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-white rounded-xl focus:border-yellow-300 focus:outline-none text-xs md:text-sm mb-4 bg-white text-purple-700 font-semibold">
                        <option value="">í•™ë…„ë„ ì„ íƒ</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                    </select>
                    
                    <div class="text-sm md:text-lg font-bold text-indigo-700 mb-3 px-3">ğŸ“– ìˆ˜ì—… ì„ íƒ</div>
                    <select id="subjectSelect" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-white rounded-xl focus:border-yellow-300 focus:outline-none text-xs md:text-sm mb-4 bg-white text-purple-700 font-semibold">
                        <option value="">ìˆ˜ì—… ì„ íƒ</option>
                        <option value="ì˜ì–´">ì˜ì–´</option>
                    </select>
                    
                    <div class="text-sm md:text-lg font-bold text-indigo-700 mb-3 px-3">ğŸ“š ë°˜ ì„ íƒ</div>
                    <select id="classSelect" class="w-full px-3 md:px-4 py-2 md:py-3 border-2 border-white rounded-xl focus:border-yellow-300 focus:outline-none text-xs md:text-sm mb-5 bg-white text-purple-700 font-semibold">
                        <option value="">ë°˜ì„ ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="1ë°˜">1ë°˜</option>
                        <option value="2ë°˜">2ë°˜</option>
                        <option value="3ë°˜">3ë°˜</option>
                        <option value="4ë°˜">4ë°˜</option>
                        <option value="5ë°˜">5ë°˜</option>
                        <option value="6ë°˜">6ë°˜</option>
                        <option value="7ë°˜">7ë°˜</option>
                        <option value="8ë°˜">8ë°˜</option>
                        <option value="9ë°˜">9ë°˜</option>
                        <option value="10ë°˜">10ë°˜</option>
                    </select>
                    
                    <div class="border-t-2 border-gray-400 border-opacity-30 my-5"></div>
                    
                    <div class="text-sm md:text-lg font-bold text-indigo-700 mb-4 px-3">ğŸ“‹ ë©”ë‰´</div>
                    <button id="menuPoints" class="menu-item w-full text-left px-3 md:px-4 py-2 md:py-3 rounded-xl font-bold text-indigo-700 bg-white bg-opacity-50 hover:bg-indigo-50 hover:bg-opacity-80 hover:shadow-lg transition-all duration-300 text-sm md:text-lg active">
                        âœ¨ í¬ì¸íŠ¸ ê´€ë¦¬
                    </button>
                    <button id="menuStudents" class="menu-item w-full text-left px-3 md:px-4 py-2 md:py-3 rounded-xl font-bold text-indigo-700 bg-white bg-opacity-50 hover:bg-indigo-50 hover:bg-opacity-80 hover:shadow-lg transition-all duration-300 text-sm md:text-lg">
                        ğŸ‘¥ í•™ìƒ ê´€ë¦¬
                    </button>
                    <button id="menuRewards" class="menu-item w-full text-left px-3 md:px-4 py-2 md:py-3 rounded-xl font-bold text-indigo-700 bg-white bg-opacity-50 hover:bg-indigo-50 hover:bg-opacity-80 hover:shadow-lg transition-all duration-300 text-sm md:text-lg">
                        ğŸ ë³´ìƒ ê´€ë¦¬
                    </button>
                    <button id="menuSettings" class="menu-item w-full text-left px-3 md:px-4 py-2 md:py-3 rounded-xl font-bold text-indigo-700 bg-white bg-opacity-50 hover:bg-indigo-50 hover:bg-opacity-80 hover:shadow-lg transition-all duration-300 text-sm md:text-lg">
                        âš™ï¸ ì„¤ì •
                    </button>
                </div>
            </div>

            <!-- ì˜¤ë²„ë ˆì´ (ëª¨ë°”ì¼ìš©) -->
            <div id="sidebarOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden md:hidden"></div>

            <!-- ë©”ì¸ ì½˜í…ì¸  -->
            <div id="mainContent" class="flex-1 md:ml-56 px-4 md:px-8 pr-4 md:pr-12">
                <!-- í¬ì¸íŠ¸ ê´€ë¦¬ -->
                <div id="pointsSection" class="space-y-8">
                    <div id="teacherControls" class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">âœ¨ í¬ì¸íŠ¸ ê´€ë¦¬</h2>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-4">
                            <select id="studentSelect" class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                                <option value="">í•™ìƒ ì„ íƒ</option>
                            </select>
                            <input type="number" id="pointValue" placeholder="í¬ì¸íŠ¸" min="1" max="10"
                                   class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                        </div>

                        <div class="grid md:grid-cols-2 gap-4 mb-4">
                            <select id="pointCategory" class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                                <option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>
                                <option value="ë°œí‘œ">ğŸ“¢ ë°œí‘œ</option>
                                <option value="ê³¼ì œ">ğŸ“ ê³¼ì œ</option>
                                <option value="ì°¸ì—¬">ğŸ™‹â€â™‚ï¸ ìˆ˜ì—… ì°¸ì—¬</option>
                                <option value="í˜‘ë ¥">ğŸ¤ íŒ€ì›Œí¬</option>
                                <option value="ì°½ì˜">ğŸ’¡ ì°½ì˜ì„±</option>
                                <option value="ê¸°íƒ€">â­ ê¸°íƒ€</option>
                            </select>
                            <input type="text" id="pointDescription" placeholder="ê°„ë‹¨í•œ ì„¤ëª… (ì„ íƒì‚¬í•­)" 
                                   class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                        </div>
                        
                        <button id="addPointBtn" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-semibold transition-colors">
                            ğŸ‰ í¬ì¸íŠ¸ ì¶”ê°€
                        </button>
                    </div>

                    <!-- í•™ìƒ ëª©ë¡ -->
                    <div id="studentsDisplay" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
                </div>

                <!-- í•™ìƒ ê´€ë¦¬ -->
                <div id="studentsSection" class="space-y-8 hidden">
                    <!-- ì—‘ì…€ ì—…ë¡œë“œ -->
                    <div class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">ğŸ“Š í•™ìƒ ëª…ë‹¨ ì—…ë¡œë“œ</h2>
                        <div class="mb-4">
                            <p class="text-sm text-gray-600 mb-2">ì—‘ì…€ íŒŒì¼ í˜•ì‹: ì—°ë²ˆ(Aì—´), ì´ë¦„(Bì—´)</p>
                            <input type="file" id="excelFile" accept=".xlsx,.xls" 
                                   class="w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                        </div>
                        <button id="uploadBtn" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-semibold transition-colors">
                            ğŸ“¤ ëª…ë‹¨ ì—…ë¡œë“œ
                        </button>
                    </div>

                    <!-- ìˆ˜ë™ í•™ìƒ ê´€ë¦¬ -->
                    <div class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">ğŸ‘¤ í•™ìƒ ê°œë³„ ê´€ë¦¬</h2>
                        <div class="grid md:grid-cols-3 gap-4 mb-4">
                            <input type="number" id="newStudentNumber" placeholder="ë²ˆí˜¸" 
                                   class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                            <input type="text" id="newStudentName" placeholder="ì´ë¦„" 
                                   class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                            <button id="addStudentBtn" class="bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-xl font-semibold transition-colors">
                                â• í•™ìƒ ì¶”ê°€
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ë³´ìƒ ê´€ë¦¬ -->
                <div id="rewardsSection" class="space-y-8 hidden">
                    <!-- ë³´ìƒ ì¶”ê°€ -->
                    <div class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">ğŸ ë³´ìƒ ì¶”ê°€</h2>
                        <div class="grid md:grid-cols-3 gap-4 mb-4">
                            <input type="text" id="rewardName" placeholder="ë³´ìƒ ì´ë¦„" 
                                   class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                            <input type="number" id="rewardPoints" placeholder="í•„ìš” í¬ì¸íŠ¸" min="1"
                                   class="px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                            <button id="addRewardBtn" class="bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-semibold transition-colors">
                                â• ë³´ìƒ ì¶”ê°€
                            </button>
                        </div>
                    </div>

                    <!-- ë³´ìƒ ëª©ë¡ -->
                    <div class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">ğŸ† ë³´ìƒ ëª©ë¡</h2>
                        <div id="rewardsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    </div>
                </div>

                <!-- ì„¤ì • -->
                <div id="settingsSection" class="space-y-8 hidden">
                    <!-- í•™ë…„ë„ ë° ìˆ˜ì—… ê´€ë¦¬ -->
                    <div class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">ğŸ“… í•™ë…„ë„ ë° ìˆ˜ì—… ê´€ë¦¬</h2>
                        
                        <!-- í•™ë…„ë„ ì¶”ê°€ -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-purple-600 mb-3">í•™ë…„ë„ ì¶”ê°€</h3>
                            <div class="flex gap-4">
                                <input type="number" id="newYear" placeholder="ì˜ˆ: 2025" min="2020" max="2030"
                                       class="flex-1 px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                                <button id="addYearBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold transition-colors">
                                    â• ì¶”ê°€
                                </button>
                            </div>
                        </div>

                        <!-- ìˆ˜ì—… ì¶”ê°€ -->
                        <div class="mb-6">
                            <h3 class="text-lg font-semibold text-purple-600 mb-3">ìˆ˜ì—… ì¶”ê°€</h3>
                            <div class="flex gap-4">
                                <input type="text" id="newSubject" placeholder="ì˜ˆ: ìˆ˜í•™, ê³¼í•™"
                                       class="flex-1 px-4 py-3 border-2 border-purple-200 rounded-xl focus:border-purple-400 focus:outline-none">
                                <button id="addSubjectBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl font-semibold transition-colors">
                                    â• ì¶”ê°€
                                </button>
                            </div>
                        </div>

                        <!-- í˜„ì¬ ì„¤ì • -->
                        <div>
                            <h3 class="text-lg font-semibold text-purple-600 mb-3">í˜„ì¬ ì„¤ì •</h3>
                            <div class="bg-gray-50 rounded-xl p-4">
                                <div id="currentSettings" class="space-y-2 text-sm text-gray-700"></div>
                            </div>
                        </div>
                    </div>

                    <!-- ë°ì´í„° ê´€ë¦¬ -->
                    <div class="bg-white rounded-2xl cute-shadow p-6">
                        <h2 class="text-2xl font-bold text-purple-600 mb-4">ğŸ’¾ ë°ì´í„° ê´€ë¦¬</h2>
                        <div class="grid md:grid-cols-2 gap-4">
                            <button id="exportDataBtn" class="bg-green-500 hover:bg-green-600 text-white py-3 rounded-xl font-semibold transition-colors">
                                ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                            </button>
                            <button id="resetDataBtn" class="bg-red-500 hover:bg-red-600 text-white py-3 rounded-xl font-semibold transition-colors">
                                ğŸ—‘ï¸ ë°ì´í„° ì´ˆê¸°í™”
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentUser = null;
        let currentYear = '';
        let currentSubject = '';
        let currentClass = '';
        let students = [];

        // ë‹¤ì–‘í•œ ì•„ë°”íƒ€ SVG
        const avatars = [
            `<svg width="60" height="60" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#FFB6C1"/>
                <circle cx="35" cy="35" r="4" fill="#FF1493"/>
                <circle cx="65" cy="35" r="4" fill="#FF1493"/>
                <path d="M 30 60 Q 50 75 70 60" stroke="#FF1493" stroke-width="3" fill="none"/>
                <circle cx="25" cy="25" r="6" fill="#FF69B4"/>
                <circle cx="75" cy="25" r="6" fill="#FF69B4"/>
            </svg>`,
            `<svg width="60" height="60" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#87CEEB"/>
                <circle cx="35" cy="38" r="3" fill="#4169E1"/>
                <circle cx="65" cy="38" r="3" fill="#4169E1"/>
                <path d="M 40 58 Q 50 65 60 58" stroke="#4169E1" stroke-width="2" fill="none"/>
                <rect x="35" y="20" width="30" height="8" rx="4" fill="#4169E1"/>
            </svg>`,
            `<svg width="60" height="60" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#98FB98"/>
                <circle cx="35" cy="40" r="4" fill="#228B22"/>
                <circle cx="65" cy="40" r="4" fill="#228B22"/>
                <ellipse cx="50" cy="60" rx="12" ry="8" fill="#228B22"/>
                <polygon points="40,15 50,5 60,15 50,25" fill="#32CD32"/>
            </svg>`,
            `<svg width="60" height="60" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#FFFF99"/>
                <circle cx="35" cy="38" r="3" fill="#FF8C00"/>
                <circle cx="65" cy="38" r="3" fill="#FF8C00"/>
                <path d="M 35 62 Q 50 72 65 62" stroke="#FF8C00" stroke-width="3" fill="none"/>
                <polygon points="45,20 50,10 55,20 50,30" fill="#FFD700"/>
            </svg>`,
            `<svg width="60" height="60" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="#DDA0DD"/>
                <circle cx="35" cy="40" r="4" fill="#8A2BE2"/>
                <circle cx="65" cy="40" r="4" fill="#8A2BE2"/>
                <path d="M 40 60 Q 50 68 60 60" stroke="#8A2BE2" stroke-width="2" fill="none"/>
                <ellipse cx="35" cy="25" rx="8" ry="12" fill="#9370DB"/>
                <ellipse cx="65" cy="25" rx="8" ry="12" fill="#9370DB"/>
            </svg>`
        ];

        // Firebase ì¸ì¦ ìƒíƒœ ë³€í™” ê°ì§€
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                currentUser = user;
                // êµì‚¬ ì¸ì¦ í™•ì¸
                const isVerified = await checkTeacherVerification(user);
                if (isVerified) {
                    showMainApp();
                } else {
                    showVerificationScreen(user);
                }
            } else {
                currentUser = null;
                showLoginScreen();
            }
        });

        // êµì‚¬ ì¸ì¦ í™•ì¸
        async function checkTeacherVerification(user) {
            try {
                const teacherRef = db.collection('teachers').doc(user.uid);
                const teacherDoc = await teacherRef.get();
                return teacherDoc.exists && teacherDoc.data().verified;
            } catch (error) {
                console.error('êµì‚¬ ì¸ì¦ í™•ì¸ ì˜¤ë¥˜:', error);
                return false;
            }
        }

        // ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
        function showLoginScreen() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('verificationScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        // ì¸ì¦ í™”ë©´ í‘œì‹œ
        function showVerificationScreen(user) {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('verificationScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
            document.getElementById('userEmail').textContent = user.email;
        }

        // ë©”ì¸ ì•± í‘œì‹œ
        function showMainApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('verificationScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            document.getElementById('userInfo').textContent = `ğŸ‘©â€ğŸ« ${currentUser.email}`;
            initializeApp();
        }

        // êµ¬ê¸€ ë¡œê·¸ì¸
        document.getElementById('googleLoginBtn').addEventListener('click', async () => {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                const result = await auth.signInWithPopup(provider);
                console.log('ë¡œê·¸ì¸ ì„±ê³µ:', result.user.email);
            } catch (error) {
                console.error('ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);
                alert('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + error.message);
            }
        });

        // êµì‚¬ ì¸ì¦
        document.getElementById('verifyBtn').addEventListener('click', async () => {
            const code = document.getElementById('verificationCode').value;
            
            if (code === 'MINAH2025') {
                try {
                    // Firebaseì— êµì‚¬ ì •ë³´ ì €ì¥
                    const teacherRef = db.collection('teachers').doc(currentUser.uid);
                    await teacherRef.set({
                        email: currentUser.email,
                        verified: true,
                        verifiedAt: new Date().toISOString()
                    });
                    
                    alert('ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!');
                    showMainApp();
                } catch (error) {
                    console.error('ì¸ì¦ ì €ì¥ ì˜¤ë¥˜:', error);
                    alert('ì¸ì¦ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            } else {
                alert('ì¸ì¦ ì½”ë“œê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                document.getElementById('verificationCode').value = '';
            }
        });

        // ì¸ì¦ ì·¨ì†Œ
        document.getElementById('cancelBtn').addEventListener('click', async () => {
            await auth.signOut();
        });

        // ë¡œê·¸ì•„ì›ƒ
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                try {
                    await auth.signOut();
                } catch (error) {
                    console.error('ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:', error);
                }
            }
        });

        // ì•± ì´ˆê¸°í™”
        function initializeApp() {
            setupMenuListeners();
            setupMobileMenu();
            setupSelectors();
            setupPointManagement();
            setupStudentManagement();
            setupRewardManagement();
            setupSettings();
            loadSettings();
        }

        // ë©”ë‰´ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupMenuListeners() {
            document.getElementById('menuPoints').addEventListener('click', () => showSection('points'));
            document.getElementById('menuStudents').addEventListener('click', () => showSection('students'));
            document.getElementById('menuRewards').addEventListener('click', () => showSection('rewards'));
            document.getElementById('menuSettings').addEventListener('click', () => showSection('settings'));
        }

        // ì„¹ì…˜ í‘œì‹œ
        function showSection(section) {
            // ëª¨ë“  ì„¹ì…˜ ìˆ¨ê¸°ê¸°
            document.getElementById('pointsSection').classList.add('hidden');
            document.getElementById('studentsSection').classList.add('hidden');
            document.getElementById('rewardsSection').classList.add('hidden');
            document.getElementById('settingsSection').classList.add('hidden');
            
            // ë©”ë‰´ í™œì„±í™” ìƒíƒœ ì œê±°
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // ì„ íƒëœ ì„¹ì…˜ í‘œì‹œ
            document.getElementById(section + 'Section').classList.remove('hidden');
            document.getElementById('menu' + section.charAt(0).toUpperCase() + section.slice(1)).classList.add('active');
        }

        // ëª¨ë°”ì¼ ë©”ë‰´ ì„¤ì •
        function setupMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');

            mobileMenuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
                sidebarOverlay.classList.toggle('hidden');
            });

            sidebarOverlay.addEventListener('click', () => {
                sidebar.classList.add('-translate-x-full');
                sidebarOverlay.classList.add('hidden');
            });
        }

        // ì„ íƒì ì„¤ì •
        function setupSelectors() {
            document.getElementById('yearSelect').addEventListener('change', (e) => {
                currentYear = e.target.value;
                loadStudents();
            });

            document.getElementById('subjectSelect').addEventListener('change', (e) => {
                currentSubject = e.target.value;
                loadStudents();
            });

            document.getElementById('classSelect').addEventListener('change', (e) => {
                currentClass = e.target.value;
                loadStudents();
            });
        }

        // í¬ì¸íŠ¸ ê´€ë¦¬ ì„¤ì •
        function setupPointManagement() {
            document.getElementById('addPointBtn').addEventListener('click', addPoint);
        }

        // í•™ìƒ ê´€ë¦¬ ì„¤ì •
        function setupStudentManagement() {
            document.getElementById('uploadBtn').addEventListener('click', uploadExcel);
            document.getElementById('addStudentBtn').addEventListener('click', addStudent);
        }

        // í•™ìƒ ë°ì´í„° ë¡œë“œ
        async function loadStudents() {
            if (!currentYear || !currentSubject || !currentClass) return;

            const classKey = `${currentYear}-${currentSubject}-${currentClass}`;
            
            try {
                // Firebaseì—ì„œ ë°ì´í„° ë¡œë“œ
                const classRef = db.collection('classes').doc(classKey);
                const docSnap = await classRef.get();
                
                if (docSnap.exists) {
                    students = docSnap.data().students || [];
                } else {
                    // ìƒˆ ë°˜ ìƒì„±
                    students = [];
                    await classRef.set({
                        year: currentYear,
                        subject: currentSubject,
                        className: currentClass,
                        students: [],
                        createdAt: new Date().toISOString(),
                        createdBy: currentUser.uid
                    });
                }
                
                // ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
                setupRealtimeListener(classKey);
                
            } catch (error) {
                console.error('Firebase ë¡œë“œ ì˜¤ë¥˜:', error);
                // ë¡œì»¬ ì €ì¥ì†Œ ë°±ì—…
                const savedStudents = JSON.parse(localStorage.getItem(classKey) || '[]');
                students = savedStudents;
            }
            
            updateStudentSelect();
            displayStudents();
        }

        // ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupRealtimeListener(classKey) {
            try {
                const classRef = db.collection('classes').doc(classKey);
                classRef.onSnapshot((doc) => {
                    if (doc.exists) {
                        students = doc.data().students || [];
                        updateStudentSelect();
                        displayStudents();
                    }
                });
            } catch (error) {
                console.error('ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ ì˜¤ë¥˜:', error);
            }
        }

        // í•™ìƒ ì„ íƒ ë“œë¡­ë‹¤ìš´ ì—…ë°ì´íŠ¸
        function updateStudentSelect() {
            const select = document.getElementById('studentSelect');
            select.innerHTML = '<option value="">í•™ìƒ ì„ íƒ</option>';
            
            students.forEach(student => {
                select.innerHTML += `<option value="${student.number}">${student.number}ë²ˆ ${student.name}</option>`;
            });
        }

        // í•™ìƒ ëª©ë¡ í‘œì‹œ
        function displayStudents() {
            const container = document.getElementById('studentsDisplay');
            container.innerHTML = '';

            students.forEach((student, index) => {
                const totalPoints = student.points ? student.points.reduce((sum, p) => sum + p.value, 0) : 0;
                const avatarIndex = index % avatars.length;
                
                const studentCard = document.createElement('div');
                studentCard.className = 'point-card bg-white rounded-2xl cute-shadow p-6 text-center hover:shadow-lg transition-all duration-300';
                studentCard.innerHTML = `
                    <div class="mb-4">${avatars[avatarIndex]}</div>
                    <h3 class="text-lg font-bold text-purple-600 mb-2">${student.number}ë²ˆ ${student.name}</h3>
                    <div class="bg-gradient-to-r from-green-400 to-blue-500 text-white rounded-full px-4 py-2 font-bold text-xl mb-4">
                        â­ ${totalPoints}ì 
                    </div>
                    <div class="text-left">
                        <h4 class="text-sm font-bold text-purple-600 mb-2">ìµœê·¼ í¬ì¸íŠ¸</h4>
                        ${!student.points || student.points.length === 0 ? 
                            '<p class="text-gray-500 text-xs">í¬ì¸íŠ¸ ì—†ìŒ</p>' :
                            `<div class="space-y-1 max-h-32 overflow-y-auto">
                                ${student.points.slice(-3).map(point => `
                                    <div class="bg-gray-50 rounded p-2 text-xs">
                                        <div class="flex justify-between">
                                            <span class="font-semibold">${point.category}</span>
                                            <span class="text-green-600">+${point.value}</span>
                                        </div>
                                        ${point.description ? `<p class="text-gray-600 mt-1">${point.description}</p>` : ''}
                                    </div>
                                `).join('')}
                            </div>`
                        }
                    </div>
                `;
                container.appendChild(studentCard);
            });
        }

        // í¬ì¸íŠ¸ ì¶”ê°€
        async function addPoint() {
            const studentNumber = parseInt(document.getElementById('studentSelect').value);
            const pointValue = parseInt(document.getElementById('pointValue').value);
            const category = document.getElementById('pointCategory').value;
            const description = document.getElementById('pointDescription').value;

            if (!studentNumber || !pointValue || !category) {
                alert('í•™ìƒ, í¬ì¸íŠ¸, ì¹´í…Œê³ ë¦¬ë¥¼ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const student = students.find(s => s.number === studentNumber);
            if (!student) {
                alert('í•™ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            if (!student.points) {
                student.points = [];
            }

            student.points.push({
                value: pointValue,
                category: category,
                description: description,
                date: new Date().toISOString()
            });

            await saveStudents();
            displayStudents();
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('pointValue').value = '';
            document.getElementById('pointDescription').value = '';
            
            alert(`${student.name}ì—ê²Œ ${pointValue}ì ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        // í•™ìƒ ì¶”ê°€
        async function addStudent() {
            const number = parseInt(document.getElementById('newStudentNumber').value);
            const name = document.getElementById('newStudentName').value.trim();

            if (!number || !name) {
                alert('ë²ˆí˜¸ì™€ ì´ë¦„ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (students.find(s => s.number === number)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë²ˆí˜¸ì…ë‹ˆë‹¤.');
                return;
            }

            students.push({
                number: number,
                name: name,
                points: []
            });

            students.sort((a, b) => a.number - b.number);
            
            await saveStudents();
            updateStudentSelect();
            displayStudents();
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('newStudentNumber').value = '';
            document.getElementById('newStudentName').value = '';
            
            alert(`${name} í•™ìƒì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        // ì—‘ì…€ ì—…ë¡œë“œ
        function uploadExcel() {
            const fileInput = document.getElementById('excelFile');
            const file = fileInput.files[0];

            if (!file) {
                alert('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, {header: 1});

                    const newStudents = [];
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        if (row[0] && row[1]) {
                            newStudents.push({
                                number: parseInt(row[0]),
                                name: row[1].toString().trim(),
                                points: []
                            });
                        }
                    }

                    if (newStudents.length === 0) {
                        alert('ìœ íš¨í•œ í•™ìƒ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }

                    students = newStudents.sort((a, b) => a.number - b.number);
                    saveStudents();
                    updateStudentSelect();
                    displayStudents();
                    
                    alert(`${newStudents.length}ëª…ì˜ í•™ìƒì´ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`);
                } catch (error) {
                    console.error('ì—‘ì…€ íŒŒì‹± ì˜¤ë¥˜:', error);
                    alert('ì—‘ì…€ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        // í•™ìƒ ë°ì´í„° ì €ì¥
        async function saveStudents() {
            if (!currentYear || !currentSubject || !currentClass) return;
            
            const classKey = `${currentYear}-${currentSubject}-${currentClass}`;
            
            try {
                // Firebaseì— ì €ì¥
                const classRef = db.collection('classes').doc(classKey);
                await classRef.update({
                    students: students,
                    lastUpdated: new Date().toISOString()
                });
            } catch (error) {
                console.error('Firebase ì €ì¥ ì˜¤ë¥˜:', error);
                // ë¡œì»¬ ì €ì¥ì†Œ ë°±ì—…
                localStorage.setItem(classKey, JSON.stringify(students));
            }
        }

        // ë³´ìƒ ê´€ë¦¬ ì„¤ì •
        function setupRewardManagement() {
            document.getElementById('addRewardBtn').addEventListener('click', addReward);
        }

        // ì„¤ì • ê´€ë¦¬
        function setupSettings() {
            document.getElementById('addYearBtn').addEventListener('click', addYear);
            document.getElementById('addSubjectBtn').addEventListener('click', addSubject);
            document.getElementById('exportDataBtn').addEventListener('click', exportData);
            document.getElementById('resetDataBtn').addEventListener('click', resetData);
        }

        // ë³´ìƒ ì¶”ê°€
        function addReward() {
            const name = document.getElementById('rewardName').value.trim();
            const points = parseInt(document.getElementById('rewardPoints').value);

            if (!name || !points) {
                alert('ë³´ìƒ ì´ë¦„ê³¼ í•„ìš” í¬ì¸íŠ¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const rewards = JSON.parse(localStorage.getItem('rewards') || '[]');
            rewards.push({
                id: Date.now(),
                name: name,
                points: points,
                createdAt: new Date().toISOString()
            });

            localStorage.setItem('rewards', JSON.stringify(rewards));
            displayRewards();
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('rewardName').value = '';
            document.getElementById('rewardPoints').value = '';
            
            alert(`ë³´ìƒ "${name}"ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }

        // ë³´ìƒ ëª©ë¡ í‘œì‹œ
        function displayRewards() {
            const container = document.getElementById('rewardsList');
            const rewards = JSON.parse(localStorage.getItem('rewards') || '[]');
            
            container.innerHTML = '';
            
            rewards.forEach(reward => {
                const rewardCard = document.createElement('div');
                rewardCard.className = 'bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-xl p-4 text-center';
                rewardCard.innerHTML = `
                    <div class="text-2xl mb-2">ğŸ†</div>
                    <h3 class="font-bold text-lg mb-2">${reward.name}</h3>
                    <p class="text-sm opacity-90">${reward.points}ì  í•„ìš”</p>
                    <button onclick="deleteReward(${reward.id})" class="mt-2 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-xs">
                        ì‚­ì œ
                    </button>
                `;
                container.appendChild(rewardCard);
            });
        }

        // ë³´ìƒ ì‚­ì œ
        function deleteReward(id) {
            if (confirm('ì´ ë³´ìƒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const rewards = JSON.parse(localStorage.getItem('rewards') || '[]');
                const filteredRewards = rewards.filter(r => r.id !== id);
                localStorage.setItem('rewards', JSON.stringify(filteredRewards));
                displayRewards();
            }
        }

        // í•™ë…„ë„ ì¶”ê°€
        function addYear() {
            const year = document.getElementById('newYear').value;
            if (!year) {
                alert('í•™ë…„ë„ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const years = JSON.parse(localStorage.getItem('years') || '["2024", "2025"]');
            if (!years.includes(year)) {
                years.push(year);
                years.sort();
                localStorage.setItem('years', JSON.stringify(years));
                updateYearOptions();
                alert(`${year}ë…„ë„ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            } else {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í•™ë…„ë„ì…ë‹ˆë‹¤.');
            }
            
            document.getElementById('newYear').value = '';
        }

        // ìˆ˜ì—… ì¶”ê°€
        function addSubject() {
            const subject = document.getElementById('newSubject').value.trim();
            if (!subject) {
                alert('ìˆ˜ì—…ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const subjects = JSON.parse(localStorage.getItem('subjects') || '["ì˜ì–´"]');
            if (!subjects.includes(subject)) {
                subjects.push(subject);
                localStorage.setItem('subjects', JSON.stringify(subjects));
                updateSubjectOptions();
                alert(`"${subject}" ìˆ˜ì—…ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            } else {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ìˆ˜ì—…ì…ë‹ˆë‹¤.');
            }
            
            document.getElementById('newSubject').value = '';
        }

        // ì„¤ì • ë¡œë“œ
        function loadSettings() {
            updateYearOptions();
            updateSubjectOptions();
            displayRewards();
            updateCurrentSettings();
        }

        // í•™ë…„ë„ ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateYearOptions() {
            const years = JSON.parse(localStorage.getItem('years') || '["2024", "2025"]');
            const select = document.getElementById('yearSelect');
            const currentValue = select.value;
            
            select.innerHTML = '<option value="">í•™ë…„ë„ ì„ íƒ</option>';
            years.forEach(year => {
                select.innerHTML += `<option value="${year}">${year}</option>`;
            });
            
            if (currentValue) select.value = currentValue;
        }

        // ìˆ˜ì—… ì˜µì…˜ ì—…ë°ì´íŠ¸
        function updateSubjectOptions() {
            const subjects = JSON.parse(localStorage.getItem('subjects') || '["ì˜ì–´"]');
            const select = document.getElementById('subjectSelect');
            const currentValue = select.value;
            
            select.innerHTML = '<option value="">ìˆ˜ì—… ì„ íƒ</option>';
            subjects.forEach(subject => {
                select.innerHTML += `<option value="${subject}">${subject}</option>`;
            });
            
            if (currentValue) select.value = currentValue;
        }

        // í˜„ì¬ ì„¤ì • í‘œì‹œ
        function updateCurrentSettings() {
            const container = document.getElementById('currentSettings');
            const years = JSON.parse(localStorage.getItem('years') || '["2024", "2025"]');
            const subjects = JSON.parse(localStorage.getItem('subjects') || '["ì˜ì–´"]');
            
            container.innerHTML = `
                <div><strong>ë“±ë¡ëœ í•™ë…„ë„:</strong> ${years.join(', ')}</div>
                <div><strong>ë“±ë¡ëœ ìˆ˜ì—…:</strong> ${subjects.join(', ')}</div>
                <div><strong>í˜„ì¬ ì„ íƒ:</strong> ${currentYear || 'ì—†ìŒ'} - ${currentSubject || 'ì—†ìŒ'} - ${currentClass || 'ì—†ìŒ'}</div>
            `;
        }

        // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        function exportData() {
            const allData = {
                students: students,
                rewards: JSON.parse(localStorage.getItem('rewards') || '[]'),
                years: JSON.parse(localStorage.getItem('years') || '["2024", "2025"]'),
                subjects: JSON.parse(localStorage.getItem('subjects') || '["ì˜ì–´"]'),
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `minah-class-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('ë°ì´í„°ê°€ ë‚´ë³´ë‚´ê¸°ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ë°ì´í„° ì´ˆê¸°í™”
        function resetData() {
            if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                if (confirm('ì •ë§ë¡œ ëª¨ë“  í•™ìƒ ë°ì´í„°ì™€ ì„¤ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    localStorage.clear();
                    students = [];
                    currentYear = '';
                    currentSubject = '';
                    currentClass = '';
                    
                    // ê¸°ë³¸ê°’ ë³µì›
                    localStorage.setItem('years', JSON.stringify(['2024', '2025']));
                    localStorage.setItem('subjects', JSON.stringify(['ì˜ì–´']));
                    
                    // UI ì—…ë°ì´íŠ¸
                    document.getElementById('yearSelect').value = '';
                    document.getElementById('subjectSelect').value = '';
                    document.getElementById('classSelect').value = '';
                    
                    loadSettings();
                    displayStudents();
                    updateStudentSelect();
                    
                    alert('ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            }
        }

        // ì „ì—­ í•¨ìˆ˜ë¡œ ì„¤ì • (HTMLì—ì„œ í˜¸ì¶œ ê°€ëŠ¥)
        window.deleteReward = function(id) {
            if (confirm('ì´ ë³´ìƒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const rewards = JSON.parse(localStorage.getItem('rewards') || '[]');
                const filteredRewards = rewards.filter(r => r.id !== id);
                localStorage.setItem('rewards', JSON.stringify(filteredRewards));
                displayRewards();
            }
        };

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            console.log('Minah Teacher\'s Class Points ì‹œì‘!');
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'970de88d14a5ea28',t:'MTc1NTQ4MzM3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
